<!-- sldsValidatorIgnore -->
<template>
    <lightning-card title="Inline Edit Html Example" icon-name="standard:folder">
        <div if:true={data} class="slds-table_edit_container slds-is-relative slds-m-around_medium">
            <table class="slds-table slds-table_bordered slds-table_edit" role="grid">
                <thead>
                    <tr class="slds-line-height_reset">
                        <th class="column_number" scope="column">
                            <div class="slds-truncate slds-assistive-text" title="Errors">Errors</div>
                        </th>
                        <th aria-label="Name" aria-sort="none" class="column_name" scope="column">
                            <a class="slds-th__action slds-text-link_reset" href="#" role="button" tabindex="-1">
                                <div class="slds-grid slds-grid_vertical-align-center slds-has-flexi-truncate">
                                    <span class="slds-truncate" title="Name">Name</span>
                                </div>
                            </a>
                        </th>
                        <th aria-label="Rating" aria-sort="none" class="column_rating" scope="column">
                            <a class="slds-th__action slds-text-link_reset" href="#" role="button" tabindex="-1">
                                <div class="slds-grid slds-grid_vertical-align-center slds-has-flexi-truncate">
                                    <span class="slds-truncate" title="Rating">Rating</span>
                                    <span class="slds-icon_container slds-icon-utility-arrowdown">
                                        <svg class="slds-icon slds-icon-text-default slds-is-sortable__icon"
                                            aria-hidden="true">
                                            <use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#arrowdown"></use>
                                        </svg>
                                    </span>
                                </div>
                            </a>
                        </th>
                        <th aria-label="Actions" aria-sort="none" class="column_actions" scope="column">
                            <a class="slds-th__action slds-text-link_reset" href="#" role="button" tabindex="-1">
                                <div class="slds-grid slds-grid_vertical-align-center slds-has-flexi-truncate">
                                    <span class="slds-truncate" title="Rating">Actions</span>
                                </div>
                            </a>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <template for:each={data} for:item="account" for:index="index">
                        <tr class="slds-hint-parent" data-index={index} key={account.Id} tabindex="-1">
                            <td role="gridcell" scope="row" style="text-align:center;width:50px;padding-right:.4rem">
                                <span class="slds-grid slds-grid_align-center">
                                    <span class="slds-truncate" title="rowNumber">{account.rowNumber}</span>
                                </span>
                            </td>
                            <td class={account.nameCellColor} role="gridcell" scope="row">
                                <span if:true={account.nameReadOnly} class="slds-cell-edit slds-cell_action-mode slds-grid slds-grid_align-spread">
                                    <span class="slds-truncate" title={account.Name}>{account.Name}</span>
                                    <lightning-button-icon
                                        onclick={handleNameAction}
                                        data-index={index}
                                        data-value={account.Name}
                                        data-id={account.Id}
                                        icon-name="utility:edit"
                                        icon-class="slds-button__icon_edit"
                                        variant="bare" title="Edit Rating of the Account"
                                        class="slds-cell-edit__button slds-m-left_x-small slds-button__icon_hint">
                                    </lightning-button-icon>
                                </span>
                                <section
                                    if:false={account.nameReadOnly}
                                    aria-describedby="dialog-body-id-14"
                                    class="slds-popover slds-popover slds-popover_edit"
                                    role="dialog"
                                    style="position:absolute;top:0;left:0.0625rem">
                                    <div class="slds-popover__body" id={account.Id}>
                                        <div class="slds-media">
                                            <div class="slds-media__body">
                                                <div class="slds-form-element slds-grid slds-wrap">
                                                    <label class="slds-form-element__label slds-form-element__label_edit slds-no-flex">
                                                        <span class="slds-assistive-text">{account.Name}</span>
                                                    </label>
                                                    <div class="slds-form-element__control slds-grow" >
                                                        <input
                                                            autofocus
                                                            type="text"
                                                            class="slds-input"
                                                            data-index={index}
                                                            data-id={account.Id}
                                                            data-field="Name"
                                                            data-fieldname="Name"
                                                            value={account.Name}
                                                            onblur={onNameBlur}
                                                            onchange={onNameChange}/>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </section>
                            </td>
                            <td class={account.ratingCellColor} role="gridcell" scope="row" tabindex="0">
                                <span if:true={account.ratingReadOnly} class="slds-cell-edit slds-cell_action-mode slds-grid slds-grid_align-spread">
                                    <span class="slds-truncate" title={account.Rating}>{account.Rating}</span>
                                    <lightning-button-icon
                                        onclick={handleRatingAction}
                                        data-index={index}
                                        data-value={account.Rating}
                                        data-id={account.Id}
                                        data-field='Rating'
                                        icon-name="utility:edit"
                                        icon-class="slds-button__icon_edit"
                                        variant="bare" title="Edit Rating of the Account"
                                        class="slds-cell-edit__button slds-m-left_x-small slds-button__icon_hint">
                                    </lightning-button-icon>
                                </span>
                                <section if:false={account.ratingReadOnly} id={account.Id}>
                                    <lightning-combobox
                                        class="combobox"
                                        style="position:absolute;top:0;left:0"
                                        variant="label-hidden"
                                        data-index={index}
                                        data-id={account.Id}
                                        data-value={account.Rating}
                                        value={account.Rating}
                                        options={pickListOptions}
                                        onchange={onRatingChange}
                                        onblur={onRatingBlur}
                                        >
                                    </lightning-combobox>
                                </section>
                            </td>
                            <td>
                                <lightning-button
                                    label="Delete"
                                    variant="Neutral"
                                    data-id={account.Id}
                                    onclick={deleteAccount}>
                                </lightning-button>
                            </td>
                        </tr>
                    </template>
                </tbody>
            </table>
            <footer if:true={showSaveCancelButton} class="slds-modal__footer">
                <div  class="slds-grid slds-grid_align-center">
                    <button class="slds-button slds-button_neutral" onclick={handleCancel}>Cancel</button>
                    <button class="slds-button slds-button_brand" onclick={handleSave}>Save</button>
                </div>
            </footer>
        </div>
    </lightning-card>
    <c-delete-Account-Modal
        if:true={deleteAccountModal}
        class="slds-show slds-is-relative"
        record-id={recordId}
        onrefresh={haldleRefresh}
        onclose={haldleClose}>
    </c-delete-Account-Modal>
</template>