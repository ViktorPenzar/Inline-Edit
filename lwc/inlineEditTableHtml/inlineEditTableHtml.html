<!-- sldsValidatorIgnore -->
<template>
    <lightning-card title="Inline Edit Html Example" icon-name="standard:folder">
        <div if:true={data} class="slds-table_edit_container slds-is-relative slds-m-around_medium">
            <table aria-multiselectable="true" class="slds-table slds-table_bordered slds-table_edit slds-table_fixed-layout slds-table_resizable-cols" role="grid" aria-label="Example inline edit table in actionable mode with cell edited">
                <thead>
                    <tr class="slds-line-height_reset">
                        <th class="slds-cell_action-mode" scope="col" style="width:0.75rem">
                            <div class="slds-truncate slds-assistive-text" title="Errors">Errors</div>
                        </th>
                        <th aria-label="Account Name" aria-sort="none" class="slds-is-resizable slds-is-sortable slds-cell_action-mode" scope="col" style="width:6.75rem">
                            <a class="slds-th__action slds-text-link_reset" href="#" role="button" tabindex="0">
                                <span class="slds-assistive-text">Sort by: </span>
                                <div class="slds-grid slds-grid_vertical-align-center slds-has-flexi-truncate">
                                    <span class="slds-truncate" title="Account Name">Name</span>
                                    <span class="slds-icon_container slds-icon-utility-arrowdown">
                                        <svg class="slds-icon slds-icon-text-default slds-is-sortable__icon " aria-hidden="true">
                                            <use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#arrowdown"></use>
                                        </svg>
                                    </span>
                                </div>
                            </a>
                        </th>
                        <th aria-label="Account Rating" aria-sort="none" class="slds-is-resizable slds-is-sortable slds-cell_action-mode" scope="col" style="width:6.75rem">
                            <a class="slds-th__action slds-text-link_reset" href="#" role="button" tabindex="0">
                                <span class="slds-assistive-text">Sort by: </span>
                                <div class="slds-grid slds-grid_vertical-align-center slds-has-flexi-truncate">
                                    <span class="slds-truncate" title="Account Rating">Rating</span>
                                    <span class="slds-icon_container slds-icon-utility-arrowdown">
                                        <svg class="slds-icon slds-icon-text-default slds-is-sortable__icon " aria-hidden="true">
                                            <use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#arrowdown"></use>
                                        </svg>
                                    </span>
                                </div>
                            </a>
                        </th>
                        <th aria-label="Actions" aria-sort="none" class="slds-is-resizable slds-is-sortable slds-cell_action-mode" scope="col" style="width:6.75rem">
                            <a class="slds-th__action slds-text-link_reset" href="#" role="button" tabindex="0">
                                <span class="slds-assistive-text">Sort by: </span>
                                <div class="slds-grid slds-grid_vertical-align-center slds-has-flexi-truncate">
                                    <span class="slds-truncate" title="Actions">Actions</span>
                                    <span class="slds-icon_container slds-icon-utility-arrowdown">
                                        <svg class="slds-icon slds-icon-text-default slds-is-sortable__icon " aria-hidden="true">
                                            <use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#arrowdown"></use>
                                        </svg>
                                    </span>
                                </div>
                            </a>
                            <div class="slds-resizable">
                                <input type="range" aria-label="Close Date column width" class="slds-resizable__input slds-assistive-text" id="cell-resize-handle-1067" max="1000" min="20" tabindex="0" />
                                    <span class="slds-resizable__handle">
                                        <span class="slds-resizable__divider"></span>
                                    </span>
                            </div>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <template for:each={data} for:item="account" for:index="index">
                    <tr data-index={index} key={account.Id} aria-selected="false" class="slds-hint-parent">
                        <td class="slds-cell-edit slds-cell-error slds-cell_action-mode" role="gridcell">
                            <button id={account.Id} class="slds-button slds-button_icon slds-button_icon-error slds-m-horizontal_xxx-small slds-hidden" aria-hidden="true" tabindex="0" title="Item 1 has errors">
                                <svg class="slds-button__icon" aria-hidden="true">
                                    <use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#error"></use>
                                </svg>
                                <span class="slds-assistive-text">Item 1 has errors</span>
                            </button>
                            <span class="slds-row-number slds-text-body_small slds-text-color_weak"></span>
                        </td>
                        <td class={account.nameCellColor} scope="row">
                            <span if:true={account.nameReadOnly} class="slds-grid slds-grid_align-spread slds-hint-parent">
                                <span class="slds-truncate" title={account.Name}>{account.Name}</span>
                                <lightning-button-icon
                                    disabled={disabled}
                                    onclick={handleNameAction}
                                    data-index={index}
                                    data-value={account.Name}
                                    data-id={account.Id}
                                    icon-name="utility:edit"
                                    icon-class=""
                                    variant="bare" 
                                    title="Edit Rating of the Account"
                                    class="slds-button__icon_edit slds-m-left_x-small slds-button__icon_hint">
                                </lightning-button-icon>
                            </span>
                            <section
                                if:false={account.nameReadOnly}
                                aria-describedby="dialog-body-id-14"
                                class="slds-popover slds-popover_edit"
                                role="dialog"
                                style="position:absolute;top:0;left:0.0625rem">
                                <div class="slds-popover__body" id={account.Id}>
                                    <div class="slds-media">
                                        <div class="slds-media__body">
                                            <div class="slds-form-element slds-grid slds-wrap">
                                                <label class="slds-form-element__label slds-form-element__label_edit slds-no-flex">
                                                    <span class="slds-assistive-text">{account.Name}</span>
                                                </label>
                                                <div class="slds-form-element__control slds-grow" >
                                                    <input
                                                        autofocus
                                                        type="text"
                                                        class="slds-input"
                                                        data-index={index}
                                                        data-id={account.Id}
                                                        data-field="Name"
                                                        data-fieldname="Name"
                                                        value={account.Name}
                                                        onblur={onNameBlur}
                                                        onchange={onNameChange}/>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </td>
                        <td class={account.ratingCellColor} role="gridcell">
                            <span if:true={account.ratingReadOnly} class="slds-grid slds-grid_align-spread">
                                <span class="slds-truncate" title={account.Rating}>{account.Rating}</span>
                                <lightning-button-icon
                                    disabled={disabled}
                                    onclick={handleRatingAction}
                                    data-index={index}
                                    data-value={account.Rating}
                                    data-id={account.Id}
                                    data-field='Rating'
                                    icon-name="utility:edit"
                                    icon-class=""
                                    variant="bare" title="Edit Rating of the Account"
                                    class="slds-button__icon_edit slds-m-left_x-small slds-button__icon_hint">
                                </lightning-button-icon>
                            </span>
                            <section
                                if:false={account.ratingReadOnly}
                                aria-describedby="dialog-body-id-14"
                                class="slds-popover slds-popover_edit"
                                role="dialog"
                                style="position:absolute;top:0;left:0.0625rem">
                                <div class="slds-popover__body" id={account.Id}>
                                    <div class="slds-media">
                                        <div class="slds-media__body">
                                            <div class="slds-form-element slds-grid slds-wrap">
                                                <label class="slds-form-element__label slds-form-element__label_edit slds-no-flex">
                                                    <span class="slds-assistive-text">{account.Rating}</span>
                                                </label>
                                                <div class="slds-form-element__control slds-grow" >
                                                    <lightning-combobox
                                                        class="combobox"
                                                        variant="label-hidden"
                                                        data-index={index}
                                                        data-id={account.Id}
                                                        data-value={account.Rating}
                                                        value={account.Rating}
                                                        options={pickListOptions}
                                                        autofocus="this.value"
                                                        onchange={onRatingChange}
                                                        onblur={onRatingBlur}>
                                                    </lightning-combobox>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </td>
                        <td>
                            <lightning-button
                                title="Delete"
                                label="Delete"
                                variant="Neutral"
                                data-id={account.Id}
                                onclick={deleteAccount}>
                            </lightning-button>
                        </td>
                    </tr>
                </template>
                </tbody>
            </table>
            <footer if:true={showSaveCancelButton} class="slds-modal__footer">
                <div  class="slds-grid slds-grid_align-center">
                    <button class="slds-button slds-button_neutral" onclick={handleCancel}>Cancel</button>
                    <button class="slds-button slds-button_brand" onclick={handleSave}>Save</button>
                </div>
            </footer>
        </div>
    </lightning-card>
    <c-delete-Account-Modal
        if:true={deleteAccountModal}
        class="slds-show slds-is-relative"
        record-id={recordId}
        onrefresh={haldleRefresh}
        onclose={haldleClose}>
    </c-delete-Account-Modal>
</template>